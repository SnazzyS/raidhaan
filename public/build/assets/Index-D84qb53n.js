import{a as p,r as $,h as z,o as R,i as j,j as P,d as e,c as i,t as n,g as r,e as y,F as N,k as V,w as T,f as h,v as q,s as H,l as m}from"./app-DDIZjqGS.js";import{_ as L}from"./AppLayout-DcxM-feb.js";import{u as G}from"./auth-CcBkgkiN.js";const J={class:"space-y-6"},K={class:"grid gap-6 lg:grid-cols-3"},O={class:"lg:col-span-2"},Q={class:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm"},W={class:"border-b border-slate-200 px-6 py-4"},X={class:"text-sm text-slate-500"},Y={key:0,class:"space-y-4 px-6 py-6"},Z={key:1,class:"min-w-full divide-y divide-slate-200 text-sm text-slate-600"},ee={class:"divide-y divide-slate-100"},te={key:0},se={class:"px-6 py-4 font-semibold text-slate-900"},ae={class:"px-6 py-4 capitalize"},oe={class:"px-6 py-4 font-semibold text-slate-900"},le={class:"px-6 py-4"},re={class:"flex flex-wrap gap-2"},ie=["onClick"],ne=["onClick"],de={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},ce={class:"mb-4"},ue={class:"text-lg font-semibold text-slate-900"},pe=["value"],me={key:0,class:"rounded-lg border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600"},xe={class:"flex flex-col gap-2"},be=["disabled"],ge={key:0,class:"-ml-1 mr-3 size-4 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},we={__name:"Index",setup(ye){const D=G(),c=p([]),u=p([]),f=p(!1),d=p(""),a=$({id:null,name:"",price:"",category_id:""}),x=p(!1),b=z(()=>a.id!==null),A=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MVR",minimumFractionDigits:2}).format(o??0),w=()=>{var o;a.id=null,a.name="",a.price="",a.category_id=((o=u.value[0])==null?void 0:o.id)??"",d.value=""},_=async()=>{var o,t;f.value=!0,d.value="";try{const[s,l]=await Promise.all([m.get("/items"),m.get("/categories")]);c.value=s.data??[],u.value=l.data??[],!a.category_id&&u.value.length&&(a.category_id=u.value[0].id)}catch(s){d.value=((t=(o=s.response)==null?void 0:o.data)==null?void 0:t.message)??"Unable to load items catalog."}finally{f.value=!1}},B=async()=>{var t,s,l,g,k,C,U,M,S,E;x.value=!0,d.value="";const o={name:a.name,price:Number(a.price),category_id:Number(a.category_id)};try{b.value?await m.put(`/items/${a.id}`,o):await m.post("/items",o),await _(),w()}catch(v){d.value=((s=(t=v.response)==null?void 0:t.data)==null?void 0:s.message)??((C=(k=(g=(l=v.response)==null?void 0:l.data)==null?void 0:g.errors)==null?void 0:k.name)==null?void 0:C[0])??((E=(S=(M=(U=v.response)==null?void 0:U.data)==null?void 0:M.errors)==null?void 0:S.price)==null?void 0:E[0])??"Unable to save the item."}finally{x.value=!1}},F=o=>{a.id=o.id,a.name=o.name,a.price=o.price,a.category_id=o.category_id},I=async o=>{var t,s;if(window.confirm("Delete this item? This action cannot be undone."))try{await m.delete(`/items/${o}`),c.value=c.value.filter(l=>l.id!==o)}catch(l){d.value=((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.message)??"Unable to delete the item."}};return R(async()=>{D.ensureAuthenticated(),await _()}),(o,t)=>(r(),j(L,null,{default:P(()=>[e("section",J,[t[13]||(t[13]=e("header",{class:"border-b border-slate-200 pb-4"},[e("h1",{class:"text-2xl font-semibold text-slate-900"},"Items"),e("p",{class:"text-sm text-slate-500"}," Maintain the product catalogue and pricing used when creating orders. ")],-1)),e("div",K,[e("section",O,[e("div",Q,[e("div",W,[t[3]||(t[3]=e("h2",{class:"text-lg font-semibold text-slate-900"},"Catalogue",-1)),e("p",X,n(c.value.length)+" items across "+n(u.value.length)+" categories. ",1)]),f.value?(r(),i("div",Y,[...t[4]||(t[4]=[e("div",{class:"h-6 w-1/2 animate-pulse rounded bg-slate-100"},null,-1),e("div",{class:"h-6 w-2/3 animate-pulse rounded bg-slate-100"},null,-1),e("div",{class:"h-6 w-1/3 animate-pulse rounded bg-slate-100"},null,-1)])])):(r(),i("table",Z,[t[6]||(t[6]=e("thead",{class:"bg-slate-50 text-xs uppercase tracking-wide text-slate-500"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left font-medium"},"Item"),e("th",{class:"px-6 py-3 text-left font-medium"},"Category"),e("th",{class:"px-6 py-3 text-left font-medium"},"Price"),e("th",{class:"px-6 py-3 text-left font-medium"},"Actions")])],-1)),e("tbody",ee,[c.value.length===0?(r(),i("tr",te,[...t[5]||(t[5]=[e("td",{colspan:"4",class:"px-6 py-6 text-center text-sm text-slate-500"}," No items yet. Use the form to create your first menu item. ",-1)])])):y("",!0),(r(!0),i(N,null,V(c.value,s=>{var l;return r(),i("tr",{key:s.id,class:"transition hover:bg-slate-50"},[e("td",se,n(s.name),1),e("td",ae,n(((l=s.category)==null?void 0:l.name)??"Uncategorised"),1),e("td",oe,n(A(s.price)),1),e("td",le,[e("div",re,[e("button",{type:"button",class:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-900",onClick:g=>F(s)}," Edit ",8,ie),e("button",{type:"button",class:"rounded-lg border border-rose-200 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:border-rose-300 hover:text-rose-700",onClick:g=>I(s.id)}," Delete ",8,ne)])])])}),128))])]))])]),e("section",de,[e("header",ce,[e("h2",ue,n(b.value?"Update item":"Add new item"),1),t[7]||(t[7]=e("p",{class:"text-sm text-slate-500"}," Set the display name, default price, and category. ",-1))]),e("form",{class:"space-y-4",onSubmit:T(B,["prevent"])},[e("div",null,[t[8]||(t[8]=e("label",{class:"text-xs font-semibold uppercase tracking-wide text-slate-500"}," Name ",-1)),h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.name=s),type:"text",required:"",minlength:"2",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10",placeholder:"Item name"},null,512),[[q,a.name,void 0,{trim:!0}]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs font-semibold uppercase tracking-wide text-slate-500"}," Price (MVR) ",-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.price=s),type:"number",step:"0.01",min:"0",required:"",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10",placeholder:"0.00"},null,512),[[q,a.price]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"text-xs font-semibold uppercase tracking-wide text-slate-500"}," Category ",-1)),h(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.category_id=s),required:"",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10 capitalize"},[t[10]||(t[10]=e("option",{value:"",disabled:""},"Select category",-1)),(r(!0),i(N,null,V(u.value,s=>(r(),i("option",{key:s.id,value:s.id},n(s.name),9,pe))),128))],512),[[H,a.category_id]])]),d.value?(r(),i("div",me,n(d.value),1)):y("",!0),e("div",xe,[e("button",{type:"submit",class:"inline-flex items-center justify-center rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 disabled:opacity-60",disabled:x.value},[x.value?(r(),i("svg",ge,[...t[12]||(t[12]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):y("",!0),e("span",null,n(b.value?"Update item":"Add item"),1)],8,be),b.value?(r(),i("button",{key:0,type:"button",class:"inline-flex items-center justify-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",onClick:w}," Cancel edit ")):y("",!0)])],32)])])])]),_:1}))}};export{we as default};
