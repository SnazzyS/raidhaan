import{a as b,r as F,h as B,o as M,i as q,j as f,d as e,m as h,t as l,c as r,g as o,F as _,k as v,n as y,p as w,u as k,q as O,e as P,l as u}from"./app-DDIZjqGS.js";import{_ as z}from"./AppLayout-DcxM-feb.js";import{u as E}from"./auth-CcBkgkiN.js";const L={class:"space-y-6"},U={class:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"},$={class:"rounded-lg border border-slate-200 bg-white px-4 py-2 text-sm font-semibold text-slate-700 shadow-sm"},G={class:"ml-2 text-base font-bold text-slate-900"},H={class:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},J={class:"text-sm font-semibold text-slate-500"},K={class:"mt-4 text-3xl font-bold text-slate-900"},Q={class:"mt-2 text-sm text-slate-500"},W={class:"grid gap-6 lg:grid-cols-2"},X={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},Y={class:"flex items-center justify-between"},Z={key:0,class:"mt-6 space-y-3"},ee={key:1,class:"mt-8 rounded-xl border border-dashed border-slate-200 bg-slate-50 p-8 text-center text-sm text-slate-500"},te={key:2,class:"mt-6 space-y-4"},se={class:"text-sm font-semibold text-slate-900"},ae={class:"text-xs text-slate-500"},le={class:"flex flex-col items-end"},oe={class:"mt-2 text-sm font-semibold text-slate-900"},re={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},ne={class:"flex items-center justify-between"},de={class:"mt-6 grid gap-4"},ie={class:"rounded-xl border border-slate-200 px-4 py-3"},ce={class:"mt-1 text-2xl font-bold text-slate-900"},me={class:"text-xs text-slate-500"},ue={class:"rounded-xl border border-slate-200 px-4 py-3"},xe={class:"mt-1 text-2xl font-bold text-slate-900"},pe={key:0,class:"mt-6 rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600"},_e={__name:"Overview",setup(ge){const C=E(),x=b(!0),i=b(""),a=F({pendingOrders:0,completedOrders:0,cancelledOrders:0,categories:0,items:0,salesTotal:0}),p=b([]),g=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"MVR",minimumFractionDigits:2}).format(n??0),N=n=>new Intl.DateTimeFormat("en",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}).format(new Date(n)),D=async()=>{var n,t;x.value=!0,i.value="";try{const[s,c,I,R]=await Promise.all([u.get("/orders"),u.get("/categories"),u.get("/items"),u.get("/sales")]),m=s.data??[],S=c.data??[],V=I.data??[],j=R.data??[];a.pendingOrders=m.filter(d=>d.status==="pending").length,a.completedOrders=m.filter(d=>d.status==="completed").length,a.cancelledOrders=m.filter(d=>d.status==="cancelled").length,a.categories=S.length,a.items=V.length,a.salesTotal=j.reduce((d,A)=>d+Number(A.total??0),0),p.value=m.slice(0,5)}catch(s){i.value=((t=(n=s.response)==null?void 0:n.data)==null?void 0:t.message)??"Unable to load dashboard data."}finally{x.value=!1}},T=B(()=>[{name:"Pending orders",value:a.pendingOrders,helper:"Awaiting processing",accent:"bg-amber-500/10 text-amber-600",badge:"Pending"},{name:"Completed today",value:a.completedOrders,helper:"Marked as fulfilled",accent:"bg-emerald-500/10 text-emerald-600",badge:"Completed"},{name:"Cancelled",value:a.cancelledOrders,helper:"Requires follow-up",accent:"bg-rose-500/10 text-rose-600",badge:"Cancelled"},{name:"Items live",value:a.items,helper:`${a.categories} categories`,accent:"bg-slate-900/10 text-slate-900",badge:"Inventory"}]);return M(async()=>{C.ensureAuthenticated(),await D()}),(n,t)=>(o(),q(z,null,{default:f(()=>[e("section",L,[e("header",U,[t[1]||(t[1]=e("div",null,[e("h1",{class:"text-2xl font-semibold text-slate-900"},"Dashboard"),e("p",{class:"text-sm text-slate-500"}," Track incoming orders, inventory health, and daily sales performance. ")],-1)),e("div",$,[t[0]||(t[0]=h(" Today’s takings ",-1)),e("span",G,l(g(a.salesTotal)),1)])]),e("div",H,[(o(!0),r(_,null,v(T.value,s=>(o(),r("article",{key:s.name,class:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"},[e("p",J,l(s.name),1),e("p",K,l(s.value),1),e("p",Q,l(s.helper),1),e("span",{class:y(["mt-4 inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",s.accent])},l(s.badge),3)]))),128))]),e("div",W,[e("section",X,[e("header",Y,[t[3]||(t[3]=e("div",null,[e("h2",{class:"text-lg font-semibold text-slate-900"},"Latest orders"),e("p",{class:"text-sm text-slate-500"},"Snapshot of the five most recent orders.")],-1)),w(k(O),{href:"/orders",class:"text-sm font-semibold text-slate-900 hover:underline"},{default:f(()=>[...t[2]||(t[2]=[h(" View all ",-1)])]),_:1})]),x.value?(o(),r("div",Z,[...t[4]||(t[4]=[e("div",{class:"h-12 w-full animate-pulse rounded-xl bg-slate-100"},null,-1),e("div",{class:"h-12 w-full animate-pulse rounded-xl bg-slate-100"},null,-1),e("div",{class:"h-12 w-full animate-pulse rounded-xl bg-slate-100"},null,-1)])])):p.value.length===0?(o(),r("div",ee," No orders yet. New orders will appear here as soon as they’re created. ")):(o(),r("ul",te,[(o(!0),r(_,null,v(p.value,s=>{var c;return o(),r("li",{key:s.id,class:"flex items-center justify-between rounded-xl border border-slate-200 px-4 py-3 transition hover:bg-slate-50"},[e("div",null,[e("p",se,l(s.order_number),1),e("p",ae,l(((c=s.customer)==null?void 0:c.phone_number)??"N/A")+" • "+l(N(s.created_at)),1)]),e("div",le,[e("span",{class:y(["inline-flex rounded-full px-3 py-1 text-xs font-semibold capitalize",{"bg-amber-100 text-amber-700":s.status==="pending","bg-emerald-100 text-emerald-700":s.status==="completed","bg-rose-100 text-rose-700":s.status==="cancelled"}])},l(s.status),3),e("span",oe,l(g(s.total_amount)),1)])])}),128))]))]),e("section",re,[e("header",ne,[t[6]||(t[6]=e("div",null,[e("h2",{class:"text-lg font-semibold text-slate-900"},"Inventory overview"),e("p",{class:"text-sm text-slate-500"},"Stay ahead of low-stock items and keep menus fresh.")],-1)),w(k(O),{href:"/items",class:"text-sm font-semibold text-slate-900 hover:underline"},{default:f(()=>[...t[5]||(t[5]=[h(" Manage items ",-1)])]),_:1})]),e("div",de,[e("div",ie,[t[7]||(t[7]=e("p",{class:"text-sm font-semibold text-slate-900"},"Items live",-1)),e("p",ce,l(a.items),1),e("p",me,"Across "+l(a.categories)+" categories.",1)]),e("div",ue,[t[8]||(t[8]=e("p",{class:"text-sm font-semibold text-slate-900"},"Daily sales",-1)),e("p",xe,l(g(a.salesTotal)),1),t[9]||(t[9]=e("p",{class:"text-xs text-slate-500"},"Sum of today’s recorded sales entries.",-1))])]),i.value?(o(),r("div",pe,l(i.value),1)):P("",!0)])])])]),_:1}))}};export{_e as default};
