import{a as x,r as B,h as S,o as $,i as j,j as q,d as e,c as i,t as c,g as r,e as g,F as D,k as M,w as N,f as F,v as V,l as b}from"./app-DDIZjqGS.js";import{_ as z}from"./AppLayout-DcxM-feb.js";import{u as A}from"./auth-CcBkgkiN.js";const O={class:"space-y-6"},P={class:"grid gap-6 lg:grid-cols-3"},H={class:"lg:col-span-2"},L={class:"overflow-hidden rounded-2xl border border-slate-200 bg-white shadow-sm"},T={class:"border-b border-slate-200 px-6 py-4"},G={class:"text-sm text-slate-500"},I={key:0,class:"space-y-4 px-6 py-6"},J={key:1,class:"divide-y divide-slate-200"},K={key:0,class:"px-6 py-6 text-center text-sm text-slate-500"},Q={class:"text-base font-semibold text-slate-900"},R={class:"text-xs text-slate-500"},W={class:"mt-3 flex flex-wrap gap-2 sm:mt-0"},X=["onClick"],Y=["onClick"],Z={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm"},ee={class:"mb-4"},te={class:"text-lg font-semibold text-slate-900"},se={key:0,class:"rounded-lg border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-600"},ae={class:"flex flex-col gap-2"},oe=["disabled"],le={key:0,class:"-ml-1 mr-3 size-4 animate-spin text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ce={__name:"Index",setup(re){const k=A(),d=x([]),v=x(!1),n=x(""),o=B({id:null,name:""}),u=x(!1),m=S(()=>o.id!==null),h=async()=>{var a,t;v.value=!0,n.value="";try{const{data:s}=await b.get("/categories");d.value=s??[]}catch(s){n.value=((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)??"Unable to load categories. Please try again."}finally{v.value=!1}},f=()=>{o.id=null,o.name="",n.value=""},C=async()=>{var t,s,l,p,y,_;u.value=!0,n.value="";const a={name:o.name};try{m.value?await b.put(`/categories/${o.id}`,a):await b.post("/categories",a),await h(),f()}catch(w){n.value=((s=(t=w.response)==null?void 0:t.data)==null?void 0:s.message)??((_=(y=(p=(l=w.response)==null?void 0:l.data)==null?void 0:p.errors)==null?void 0:y.name)==null?void 0:_[0])??"Unable to save the category."}finally{u.value=!1}},E=a=>{o.id=a.id,o.name=a.name},U=async a=>{var t,s;if(window.confirm("Deleting this category will uncategorise its items. Continue?"))try{await b.delete(`/categories/${a}`),d.value=d.value.filter(l=>l.id!==a)}catch(l){n.value=((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.message)??"Unable to delete the category."}};return $(async()=>{k.ensureAuthenticated(),await h()}),(a,t)=>(r(),j(z,null,{default:q(()=>[e("section",O,[t[6]||(t[6]=e("header",{class:"border-b border-slate-200 pb-4"},[e("h1",{class:"text-2xl font-semibold text-slate-900"},"Categories"),e("p",{class:"text-sm text-slate-500"}," Organise menu items by category to make order entry faster. ")],-1)),e("div",P,[e("section",H,[e("div",L,[e("div",T,[t[1]||(t[1]=e("h2",{class:"text-lg font-semibold text-slate-900"},"Category list",-1)),e("p",G,c(d.value.length)+" categories in total. ",1)]),v.value?(r(),i("div",I,[...t[2]||(t[2]=[e("div",{class:"h-6 w-1/2 animate-pulse rounded bg-slate-100"},null,-1),e("div",{class:"h-6 w-2/3 animate-pulse rounded bg-slate-100"},null,-1),e("div",{class:"h-6 w-1/4 animate-pulse rounded bg-slate-100"},null,-1)])])):(r(),i("ul",J,[d.value.length===0?(r(),i("li",K," No categories created yet. Use the form to add the first one. ")):g("",!0),(r(!0),i(D,null,M(d.value,s=>{var l;return r(),i("li",{key:s.id,class:"flex flex-col border-slate-100 px-6 py-4 transition hover:bg-slate-50 sm:flex-row sm:items-center sm:justify-between"},[e("div",null,[e("p",Q,c(s.name),1),e("p",R,c(((l=s.items)==null?void 0:l.length)??0)+" items ",1)]),e("div",W,[e("button",{type:"button",class:"rounded-lg border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-900",onClick:p=>E(s)}," Edit ",8,X),e("button",{type:"button",class:"rounded-lg border border-rose-200 px-3 py-1.5 text-xs font-semibold text-rose-600 transition hover:border-rose-300 hover:text-rose-700",onClick:p=>U(s.id)}," Delete ",8,Y)])])}),128))]))])]),e("section",Z,[e("header",ee,[e("h2",te,c(m.value?"Update category":"Create category"),1),t[3]||(t[3]=e("p",{class:"text-sm text-slate-500"}," Categories help group items on receipts and in the POS. ",-1))]),e("form",{class:"space-y-4",onSubmit:N(C,["prevent"])},[e("div",null,[t[4]||(t[4]=e("label",{class:"text-xs font-semibold uppercase tracking-wide text-slate-500"}," Name ",-1)),F(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.name=s),type:"text",required:"",minlength:"2",class:"mt-1 w-full rounded-lg border border-slate-300 px-3 py-2 text-sm text-slate-900 shadow-sm focus:border-slate-900 focus:outline-none focus:ring-2 focus:ring-slate-900/10",placeholder:"e.g. Beverages"},null,512),[[V,o.name,void 0,{trim:!0}]])]),n.value?(r(),i("div",se,c(n.value),1)):g("",!0),e("div",ae,[e("button",{type:"submit",class:"inline-flex items-center justify-center rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-slate-800 disabled:opacity-60",disabled:u.value},[u.value?(r(),i("svg",le,[...t[5]||(t[5]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):g("",!0),e("span",null,c(m.value?"Update category":"Create category"),1)],8,oe),m.value?(r(),i("button",{key:0,type:"button",class:"inline-flex items-center justify-center rounded-lg border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600 transition hover:border-slate-400 hover:text-slate-900",onClick:f}," Cancel edit ")):g("",!0)])],32)])])])]),_:1}))}};export{ce as default};
